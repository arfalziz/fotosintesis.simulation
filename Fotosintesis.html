<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Fotosintesis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            border-radius: 1.5rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
            padding: 2rem; /* p-8 */
            max-width: 700px;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* gap-6 */
        }
        .header {
            text-align: center;
            color: #2c3e50; /* text-gray-800 */
        }
        .simulation-area {
            position: relative;
            width: 100%;
            height: 350px;
            background: linear-gradient(to bottom, #87ceeb, #a7d9ed); /* Sky blue background */
            border-radius: 0.75rem; /* rounded-lg */
            overflow: hidden;
            border: 2px solid #b2ebf2;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Plant/Leaf Visuals */
        .plant {
            position: relative;
            width: 180px;
            height: 180px;
            background-color: #2ecc71; /* Green plant */
            border-radius: 50% 50% 10px 10px; /* Simple leaf shape */
            z-index: 2;
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffffff;
            border: 3px solid #27ae60;
        }
        .plant::before, .plant::after {
            content: '';
            position: absolute;
            background-color: #27ae60;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            z-index: -1;
        }
        .plant::before { top: 0; left: -20px; }
        .plant::after { top: 0; right: -20px; }


        /* Input/Output Particles */
        .sunlight-particle {
            position: absolute;
            background-color: rgba(255, 255, 0, 0.8); /* Yellow light */
            border-radius: 50%;
            animation: fallAndFade linear infinite;
        }
        @keyframes fallAndFade {
            0% { transform: translateY(-20px) scale(0.5); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(370px) scale(1.0); opacity: 0; }
        }

        .co2-particle {
            position: absolute;
            background-color: rgba(149, 165, 166, 0.8); /* Gray CO2 */
            border-radius: 50%;
            animation: moveTowardsPlant linear infinite;
        }
        .water-particle {
            position: absolute;
            background-color: rgba(52, 152, 219, 0.8); /* Blue water */
            border-radius: 50%;
            animation: moveTowardsPlant linear infinite;
        }
        @keyframes moveTowardsPlant {
            0% { transform: translate(var(--start-x), var(--start-y)) scale(0.5); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translate(var(--end-x), var(--end-y)) scale(1.0); opacity: 0; }
        }


        .oxygen-particle {
            position: absolute;
            background-color: rgba(236, 240, 241, 0.8); /* White Oxygen */
            border-radius: 50%;
            animation: riseAndFadeOut linear infinite;
        }
        @keyframes riseAndFadeOut {
            0% { transform: translateY(0) scale(0.5); opacity: 0.8; }
            100% { transform: translateY(-300px) scale(1.5); opacity: 0; }
        }

        .glucose-particle {
            position: absolute;
            background-color: rgba(243, 156, 18, 0.8); /* Orange Glucose */
            border-radius: 50%;
            opacity: 0;
        }

        /* Displays */
        .output-display {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #2c3e50;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 8px 12px;
            border-radius: 0.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 3;
        }

        .status-message {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.75rem;
            border-radius: 0.5rem;
            background-color: #ffeeba; /* bg-yellow-100 */
            color: #856404; /* text-yellow-800 */
            border: 1px solid #ffda6c; /* border-yellow-400 */
            text-align: center;
            width: 80%;
            max-width: 400px;
            z-index: 3;
        }

        /* Controls */
        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem; /* gap-6 */
        }
        .slider-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            width: 100%;
            max-width: 200px; /* Limit width for sliders */
        }
        .slider-group label {
            font-weight: 600;
            color: #34495e;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        input[type="range"] {
            width: 100%;
            -webkit-appearance: none;
            height: 8px;
            background: #d1d5db;
            border-radius: 5px;
            outline: none;
            transition: opacity .2s;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        button {
            background-color: #28a745;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 150px;
            margin-top: 1rem; /* Added margin */
        }
        button:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="text-3xl font-bold mb-2">Simulasi Fotosintesis</h1>
            <p class="text-gray-600">
                Amati bagaimana tumbuhan menggunakan cahaya, air, dan CO2 untuk menghasilkan glukosa dan oksigen.
            </p>
        </div>

        <div class="simulation-area" id="simulationArea">
            <div class="plant" id="plant">Daun</div>
            <div id="outputDisplay" class="output-display">
                O2: 0<br>Glukosa: 0
            </div>
            <div id="statusMessage" class="status-message">Sesuaikan faktor-faktor untuk memulai fotosintesis!</div>
        </div>

        <div class="controls">
            <div class="slider-group">
                <label for="sunlight">
                    Intensitas Cahaya: <span id="sunlightValue">0%</span>
                </label>
                <input type="range" id="sunlight" min="0" max="100" value="50">
            </div>
            <div class="slider-group">
                <label for="co2">
                    Ketersediaan CO2: <span id="co2Value">0%</span>
                </label>
                <input type="range" id="co2" min="0" max="100" value="50">
            </div>
            <div class="slider-group">
                <label for="water">
                    Ketersediaan Air: <span id="waterValue">0%</span>
                </label>
                <input type="range" id="water" min="0" max="100" value="50">
            </div>
            <button id="resetButton">Reset Simulasi</button>
        </div>
    </div>

    <script>
        const simulationArea = document.getElementById('simulationArea');
        const plantElement = document.getElementById('plant');
        const sunlightSlider = document.getElementById('sunlight');
        const co2Slider = document.getElementById('co2');
        const waterSlider = document.getElementById('water');
        const sunlightValueSpan = document.getElementById('sunlightValue');
        const co2ValueSpan = document.getElementById('co2Value');
        const waterValueSpan = document.getElementById('waterValue');
        const outputDisplay = document.getElementById('outputDisplay');
        const statusMessage = document.getElementById('statusMessage');
        const resetButton = document.getElementById('resetButton');

        // Initial values for production
        let oxygenProduced = 0;
        let glucoseProduced = 0;

        // Particle generation intervals
        let sunlightInterval, co2Interval, waterInterval, oxygenInterval, glucoseTimeout;

        function updateSimulation() {
            const sunlight = parseInt(sunlightSlider.value);
            const co2 = parseInt(co2Slider.value);
            const water = parseInt(waterSlider.value);

            // Update slider value displays
            sunlightValueSpan.textContent = `${sunlight}%`;
            co2ValueSpan.textContent = `${co2}%`;
            waterValueSpan.textContent = `${water}%`;

            // Determine the limiting factor for photosynthesis rate
            // The rate is limited by the factor that is scarcest
            const limitingFactor = Math.min(sunlight, co2, water);
            const photosynthesisRate = limitingFactor / 100; // Normalized rate from 0 to 1

            // Update output display
            outputDisplay.innerHTML = `O2: ${oxygenProduced.toFixed(0)}<br>Glukosa: ${glucoseProduced.toFixed(0)}`;

            // Clear existing intervals to prevent accumulation
            clearInterval(sunlightInterval);
            clearInterval(co2Interval);
            clearInterval(waterInterval);
            clearInterval(oxygenInterval);
            clearTimeout(glucoseTimeout); // Clear previous glucose animation

            // Remove all existing particles before creating new ones based on current rate
            document.querySelectorAll('.sunlight-particle, .co2-particle, .water-particle, .oxygen-particle, .glucose-particle').forEach(p => p.remove());

            // Create particles based on rates
            if (sunlight > 0) {
                sunlightInterval = setInterval(() => createParticle('sunlight'), Math.max(20, 1000 / (sunlight * 0.5)));
            }
            if (co2 > 0) {
                co2Interval = setInterval(() => createParticle('co2'), Math.max(20, 1000 / (co2 * 0.5)));
            }
            if (water > 0) {
                waterInterval = setInterval(() => createParticle('water'), Math.max(20, 1000 / (water * 0.5)));
            }

            // Produce Oxygen and Glucose
            if (photosynthesisRate > 0) {
                statusMessage.textContent = `Fotosintesis sedang berjalan!`;
                statusMessage.classList.remove('bg-yellow-100', 'text-yellow-800', 'border-yellow-400');
                statusMessage.classList.add('bg-green-100', 'text-green-800', 'border-green-400');

                oxygenInterval = setInterval(() => {
                    if (photosynthesisRate > 0) {
                        oxygenProduced += 1 * photosynthesisRate;
                        createParticle('oxygen');
                        outputDisplay.innerHTML = `O2: ${oxygenProduced.toFixed(0)}<br>Glukosa: ${glucoseProduced.toFixed(0)}`;
                    }
                }, Math.max(50, 500 / photosynthesisRate)); // Faster production with higher rate

                // Glucose is a bit slower than oxygen, as it's the main product
                glucoseTimeout = setTimeout(function produceGlucose() {
                    if (photosynthesisRate > 0) {
                        glucoseProduced += 1 * photosynthesisRate;
                        createParticle('glucose');
                        outputDisplay.innerHTML = `O2: ${oxygenProduced.toFixed(0)}<br>Glukosa: ${glucoseProduced.toFixed(0)}`;
                        glucoseTimeout = setTimeout(produceGlucose, Math.max(100, 1000 / photosynthesisRate)); // Slower production
                    }
                }, Math.max(100, 1000 / photosynthesisRate));

            } else {
                // No photosynthesis
                let message = 'Sesuaikan faktor-faktor untuk memulai fotosintesis!';
                if (sunlight === 0) message = 'Tidak ada cahaya matahari! Fotosintesis berhenti.';
                else if (co2 === 0) message = 'Tidak ada Karbon Dioksida! Fotosintesis berhenti.';
                else if (water === 0) message = 'Tidak ada Air! Fotosintesis berhenti.';
                statusMessage.textContent = message;
                statusMessage.classList.remove('bg-green-100', 'text-green-800', 'border-green-400');
                statusMessage.classList.add('bg-yellow-100', 'text-yellow-800', 'border-yellow-400');
            }
        }

        function createParticle(type) {
            const particle = document.createElement('div');
            const size = Math.random() * 8 + 4; // 4-12px
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.classList.add(`${type}-particle`);

            const simRect = simulationArea.getBoundingClientRect();
            const plantRect = plantElement.getBoundingClientRect();

            if (type === 'sunlight') {
                particle.style.top = `-20px`; // Start above
                particle.style.left = `${Math.random() * simRect.width}px`;
                particle.style.animationDuration = `${Math.random() * 2 + 1.5}s`; // 1.5-3.5s
                simulationArea.appendChild(particle);
            } else if (type === 'co2' || type === 'water') {
                // Make CO2 come from left/right and water from bottom-left
                let startX, startY, endX, endY;
                const offset = 20; // Margin from plant edge for 'entry point'

                if (type === 'co2') {
                    // CO2 from random sides, targeting top-left/right of plant
                    if (Math.random() < 0.5) { // From left
                        startX = -20;
                        startY = Math.random() * simRect.height;
                        endX = plantRect.left - simRect.left + offset;
                        endY = plantRect.top - simRect.top + Math.random() * (plantRect.height / 2);
                    } else { // From right
                        startX = simRect.width + 20;
                        startY = Math.random() * simRect.height;
                        endX = plantRect.right - simRect.left - offset;
                        endY = plantRect.top - simRect.top + Math.random() * (plantRect.height / 2);
                    }
                } else { // type === 'water'
                    // Water from bottom-left, targeting bottom of plant
                    startX = -20;
                    startY = simRect.height + 20;
                    endX = plantRect.left - simRect.left + Math.random() * plantRect.width;
                    endY = plantRect.bottom - simRect.top - offset;
                }

                particle.style.setProperty('--start-x', `${startX}px`);
                particle.style.setProperty('--start-y', `${startY}px`);
                particle.style.setProperty('--end-x', `${endX - startX}px`); // Relative movement
                particle.style.setProperty('--end-y', `${endY - startY}px`);
                particle.style.animationDuration = `${Math.random() * 2 + 2}s`; // 2-4s

                simulationArea.appendChild(particle);

            } else if (type === 'oxygen') {
                // Oxygen bubbles from plant to top
                particle.style.left = `${plantRect.left - simRect.left + (Math.random() * plantRect.width)}px`;
                particle.style.bottom = `${simRect.height - (plantRect.top - simRect.top) - (plantRect.height / 4)}px`; // From top of plant
                particle.style.animationDuration = `${Math.random() * 2 + 2}s`; // 2-4s
                simulationArea.appendChild(particle);
            } else if (type === 'glucose') {
                // Glucose particle (just appears briefly near plant, doesn't move much)
                particle.style.left = `${plantRect.left - simRect.left + (plantRect.width / 2) - (size / 2) + (Math.random() * 40 - 20)}px`;
                particle.style.top = `${plantRect.top - simRect.top + (plantRect.height / 2) - (size / 2) + (Math.random() * 40 - 20)}px`;
                particle.style.opacity = 1;
                particle.style.transition = 'opacity 0.5s ease-out';
                simulationArea.appendChild(particle);
                setTimeout(() => {
                    particle.style.opacity = 0;
                    setTimeout(() => particle.remove(), 500); // Remove after fade out
                }, 500); // Show for 0.5s
            }

            // Remove particle after its animation
            if (type !== 'glucose') {
                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
        }

        // Event listeners for sliders
        sunlightSlider.addEventListener('input', updateSimulation);
        co2Slider.addEventListener('input', updateSimulation);
        waterSlider.addEventListener('input', updateSimulation);

        // Reset button functionality
        resetButton.addEventListener('click', () => {
            // Stop all animations
            clearInterval(sunlightInterval);
            clearInterval(co2Interval);
            clearInterval(waterInterval);
            clearInterval(oxygenInterval);
            clearTimeout(glucoseTimeout);

            // Reset production counts
            oxygenProduced = 0;
            glucoseProduced = 0;

            // Reset slider values
            sunlightSlider.value = 50;
            co2Slider.value = 50;
            waterSlider.value = 50;

            // Remove all particles from the simulation area
            document.querySelectorAll('.sunlight-particle, .co2-particle, .water-particle, .oxygen-particle, .glucose-particle').forEach(p => p.remove());

            // Update display and restart simulation (implicitly through updateSimulation)
            updateSimulation();
            statusMessage.textContent = 'Sesuaikan faktor-faktor untuk memulai fotosintesis!';
            statusMessage.classList.remove('bg-green-100', 'text-green-800', 'border-green-400');
            statusMessage.classList.add('bg-yellow-100', 'text-yellow-800', 'border-yellow-400');
        });

        // Initial setup
        window.onload = updateSimulation;

    </script>
</body>
</html>

